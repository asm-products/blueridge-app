/*! blueridge 13-07-2013 */
!function(a,b){b.module("blueRidgeApp",["blueRidgeApp.controllers","blueRidgeApp.services","blueRidgeApp.directives","ui.bootstrap","restangular"]).config(["$routeProvider","$locationProvider","$dialogProvider","RestangularProvider",function(a,b,c,d){a.when("/",{templateUrl:"views/site/home.html",controller:"HomeCtrl"}).when("/todos",{templateUrl:"views/app/todos.html",controller:"ToDoCtrl"}).when("/me",{templateUrl:"views/app/me.html",controller:"MeCtrl"}).when("/projects",{templateUrl:"views/app/projects.html",controller:"ProjectCtrl"}).when("/signout",{templateUrl:"views/site/home.html",controller:"SignOutCtrl"}).when("/connect",{templateUrl:"views/site/home.html",controller:"ConnectCtrl"}).when("/basecamp",{templateUrl:"views/app/init.html",controller:"BasecampCtrl"}).when("/pricing",{templateUrl:"views/site/pricing.html"}).when("/preview",{templateUrl:"views/site/preview.html"}).when("/privacy",{templateUrl:"views/site/privacy.html"}).otherwise({redirectTo:"/"}),b.html5Mode(!0),d.setBaseUrl("/api"),d.setListTypeIsArray(!1)}]).run(),b.module("blueRidgeApp.controllers",[]).controller("HomeCtrl",["$scope","$location","Auth",function(a,b,c){c.isSignedIn()&&b.path("/todos")}]).controller("ProjectCtrl",["$scope","$location","Restangular","Auth",function(a,b,c,d){d.isSignedIn()||b.path("/");var e=c.one("users",d.getProfileUser().id);a.user=e.get(),a.updated=!1,a.updateAccounts=function(b){e.accounts=b,e.put().then(function(){a.updated=!0})}}]).controller("SignOutCtrl",["$scope","$location","Auth",function(a,b,c){c.signOut(),b.path("/")}]).controller("SignInCtrl",["$scope","$location","Auth",function(a,b,c){a.opts={backdropFade:!0,dialogFade:!0},a.open=function(){a.shouldBeOpen=!0},a.close=function(){a.shouldBeOpen=!1},a.signin=function(d){a.signedIn=c.authorize(d),a.signedIn&&b.path("/activity")}}]).controller("ToDoCtrl",["$scope","$location","$filter","Restangular","Auth",function(a,b,c,d,e){e.isSignedIn()||b.path("/");var f=d.one("users",e.getProfileUser().id);a.user=f.get(),a.loading=!0,f.all("todos").getList().then(function(b){var c=b.todos;a.todos=c,a.loading=!1})}]).controller("MeCtrl",["$scope","$location","Auth","Restangular",function(a,b,c,d){c.isSignedIn()||b.path("/");var e=d.one("users",c.getProfileUser().id);a.user=e.get()}]).controller("ConnectCtrl",["$scope","Restangular",function(b,c){c.one("providers","basecamp").get().then(function(b){a.location=b.authUrl})}]).controller("BasecampCtrl",["$scope","$location","Restangular","Auth",function(a,b,c,d){var e=b.search().code,f=c.all("users");f.post({code:e,provider:"basecamp"}).then(function(a){d.authorize(a),b.path("/projects").search("code",null)},function(){console.log("There was an error saving")})}]),b.module("blueRidgeApp.directives",[]).directive("loadingContainer",function(){return{restrict:"A",scope:!1,link:function(a,b,c){var d=$('<div class="loading"></div>').appendTo(b);$(b).addClass("loading-container"),a.$watch(c.loadingContainer,function(a){d.toggle(a)})}}}),b.module("blueRidgeApp.services",["ngCookies"]).factory("Auth",["$cookieStore",function(a){return{authorize:function(b){return a.put("_blrdgapp",b),!0},signOut:function(){return a.remove("_blrdgapp")},isSignedIn:function(){return a.get("_blrdgapp")?!0:!1},getProfileUser:function(){return a.get("_blrdgapp")}}}])}(window,window.angular);